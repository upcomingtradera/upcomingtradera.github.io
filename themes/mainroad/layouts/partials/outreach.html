<div class="outreach_container">
	<h4>Did you enjoy the Article?</h4>
	<b>Don't Miss Out! Get customized financial news just for you!</b>
	<form id="outreach_form">
		<input type="text" name="name" style="display:none;">
		<input type="email" placeholder="Enter your email" name="email" required>
		<input type="date" name="date" value="" style="display:none">
		<input type="submit" value="Subscribe">
	</form>
</div>

<script>
	document.getElementById('outreach_form').addEventListener('submit', function(event) {
			event.preventDefault();

			const formData = new FormData(this);
			const email = formData.get('email','');
			const _date = formData.get('date','');
			const _name = formData.get('name','');
			const currentPageUrl = window.location.href;

			const apiGatewayUrl = "https://ryg8rmibh5.execute-api.us-east-1.amazonaws.com/upcomingtrader_email_submit_stage/outreach";
			//console.log(currentPageUrl)
			//console.log(email)
			//console.log(_date)
			//console.log(_name)
			//console.log(apiGatewayUrl)
			// Example: Sending the email to your server
			fetch(apiGatewayUrl, {
					method: 'POST',
					mode:   'cors',
					headers: {
							'Content-Type': 'application/json'
						},
					body: JSON.stringify({
							'email': email,
							'pageUrl': currentPageUrl,
							'date': _date,
							'name': _name
						})
				})
				.then(response => {
						if (!response.ok) {
								throw new Error('Network response was not ok');
							}
						return response.json();
					})
				.then(data => {
						console.log('Success:', data);
						createAndShowModal();
						this.reset();
					})
				.catch((error) => {
						console.error('Error:', error);
					});
		});


	function createAndShowModal() {
			// Create the modal container
			const modalContainer = document.createElement('div');
			modalContainer.id = 'dynamicModal';
			modalContainer.style.cssText = `
       position: fixed; 
       z-index: 100; 
       left: 0; 
       top: 0; 
       width: 100%; 
       height: 100%; 
       overflow: auto; 
       background-color: rgba(0,0,0,0.4); 
       display: flex; 
       justify-content: center; 
       align-items: center;
       padding: 20px;`;

			// Create the modal content
			const modalContent = document.createElement('div');
			modalContent.style.cssText = `
       background-color: #fefefe; 
       margin: auto; 
       padding: 20px; 
       border: 1px solid #888; 
       width: 80%; 
       max-width: 600px; 
       border-radius: 10px; 
       box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);`;

			// Create the close button
			const closeButton = document.createElement('span');
			closeButton.innerHTML = '&times;';
			closeButton.style.cssText = `
       color: #aaa; 
       float: right; 
       font-size: 28px; 
       font-weight: bold; 
       cursor: pointer;`;
			closeButton.onclick = function() {
					modalContainer.remove();
				};

			// Create the main content
			const content = document.createElement('p');
			content.textContent = 'Thank you for submitting your email! Please check your email for updates';

			// Create the okay button
			const okayButton = document.createElement('button');
			okayButton.textContent = 'Okay';
			okayButton.onclick = function() {
					modalContainer.remove();
				};

			// Append everything
			modalContent.appendChild(closeButton);
			modalContent.appendChild(content);
			modalContent.appendChild(okayButton);
			modalContainer.appendChild(modalContent);

			// Append the modal to the body
			document.body.appendChild(modalContainer);
		}
</script>
